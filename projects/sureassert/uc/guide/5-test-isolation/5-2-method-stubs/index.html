<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.sureassert.com/uc/guide/5-test-isolation/5-2-method-stubs/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 04 Mar 2017 11:46:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<link rel="shortcut icon" href="../../../../wp-content/themes/twentyten/favicon.ico" type="image/x-icon" />
<link rel="icon" href="../../../../wp-content/themes/twentyten/favicon.ico" type="image/x-icon" />
<meta charset="UTF-8" />
<title>5.2. Method Stubs | Sureassert UC</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="../../../../wp-content/themes/twentyten/style.css" />
<link rel="pingback" href="../../../../xmlrpc.php" />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Sureassert UC &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Sureassert UC &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Sureassert UC &raquo; 5.2. Method Stubs Comments Feed" href="feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.sureassert.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='https://api.w.org/' href='../../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.7.2" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='../../../indexf705.html?p=481' />
<link rel="alternate" type="application/json+oembed" href="../../../wp-json/oembed/1.0/embed45c5.json?url=http%3A%2F%2Fwww.sureassert.com%2Fuc%2Fguide%2F5-test-isolation%2F5-2-method-stubs%2F" />
<link rel="alternate" type="text/xml+oembed" href="../../../wp-json/oembed/1.0/embed6722?url=http%3A%2F%2Fwww.sureassert.com%2Fuc%2Fguide%2F5-test-isolation%2F5-2-method-stubs%2F&amp;format=xml" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #ffffff; }
</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="page-template-default page page-id-481 page-child parent-pageid-475 custom-background">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			
			<div id="branding" role="banner">
				<!--
								<div id="site-title">
					<span>
						<a href="http://www.sureassert.com/uc/" title="Sureassert UC" rel="home">Sureassert UC</a>
					</span>
				</div>
				<div id="site-description"></div>
				-->
										<img src="../../../../wp-content/uploads/2011/03/Sureassert7.png" width="940" height="198" alt="" />
								</div><!-- #branding -->
			
			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
								<div class="menu"><ul>
<li ><a href="../../../index.html">Home</a></li><li class="page_item page-item-232"><a href="../../../news/index.html">News</a></li>
<li class="page_item page-item-43 page_item_has_children"><a href="../../../features/index.html">Features</a>
<ul class='children'>
	<li class="page_item page-item-51"><a href="../../../features/use-cases/index.html">Exemplars</a></li>
	<li class="page_item page-item-53"><a href="../../../features/automatic-continuous-testing/index.html">Automatic Continuous Testing</a></li>
	<li class="page_item page-item-55"><a href="../../../features/real-time-continuous-test-coverage-reporting/index.html">Real-Time Continuous Test Coverage Reporting</a></li>
	<li class="page_item page-item-59"><a href="../../../features/declarative-stubbing/index.html">Declarative Stubbing</a></li>
	<li class="page_item page-item-61"><a href="../../../features/comprehensive-junit-integration/index.html">Comprehensive JUnit integration</a></li>
</ul>
</li>
<li class="page_item page-item-304 page_item_has_children current_page_ancestor"><a href="../../index.html">Guide</a>
<ul class='children'>
	<li class="page_item page-item-289 page_item_has_children"><a href="../../1-key-concepts/index.html">1. Key Concepts</a>
	<ul class='children'>
		<li class="page_item page-item-323"><a href="../../1-key-concepts/1-1-declarative-unit-testing-with-exemplars/index.html">1.1. Declarative Unit Testing with Exemplars</a></li>
		<li class="page_item page-item-325"><a href="../../1-key-concepts/continuous-unit-testing/index.html">1.2. Continuous Unit Testing</a></li>
		<li class="page_item page-item-329"><a href="../../1-key-concepts/1-3-real-time-test-coverage-reporting/index.html">1.3. Real-time Test Coverage Reporting</a></li>
		<li class="page_item page-item-333"><a href="../../1-key-concepts/1-4-junit-integration/index.html">1.4. JUnit Integration</a></li>
		<li class="page_item page-item-335"><a href="../../1-key-concepts/1-5-about-adding-the-sureassert-dependency/index.html">1.5. About Adding the Sureassert Dependency</a></li>
		<li class="page_item page-item-337"><a href="../../1-key-concepts/1-6-about-adding-declarative-tests-to-your-production-code/index.html">1.6. About Adding Declarative Tests to your Production Code</a></li>
		<li class="page_item page-item-340"><a href="../../1-key-concepts/1-7-use-cases/index.html">1.7. Use Cases</a></li>
		<li class="page_item page-item-342"><a href="../../1-key-concepts/1-8-stubbing-and-mocking/index.html">1.8. Stubbing and Mocking</a></li>
	</ul>
</li>
	<li class="page_item page-item-291 page_item_has_children"><a href="../../2-the-sureassert-uc-engine-for-eclipse/index.html">2. The Sureassert UC Engine for Eclipse</a>
	<ul class='children'>
		<li class="page_item page-item-348"><a href="../../2-the-sureassert-uc-engine-for-eclipse/2-1-automatic-incremental-execution/index.html">2.1. Automatic Incremental Execution</a></li>
		<li class="page_item page-item-350"><a href="../../2-the-sureassert-uc-engine-for-eclipse/2-2-the-background-uc-engine/index.html">2.2. The Background UC Engine</a></li>
		<li class="page_item page-item-352"><a href="../../2-the-sureassert-uc-engine-for-eclipse/2-3-forcing-sureassert-uc-execution/index.html">2.3. Forcing Sureassert UC Execution</a></li>
		<li class="page_item page-item-354"><a href="../../2-the-sureassert-uc-engine-for-eclipse/2-4-debugging-exemplars-and-junits-with-sureassert-uc/index.html">2.4. Debugging Exemplars and JUnits</a></li>
		<li class="page_item page-item-356"><a href="../../2-the-sureassert-uc-engine-for-eclipse/2-5-testing-deadlocks-and-stopping-the-uc-engine/index.html">2.5. Testing Deadlocks and Stopping the UC Engine</a></li>
	</ul>
</li>
	<li class="page_item page-item-296 page_item_has_children"><a href="../../3-exemplars/index.html">3. Exemplars</a>
	<ul class='children'>
		<li class="page_item page-item-358"><a href="../../3-exemplars/3-1-annotating-methods-with-exemplars/index.html">3.1. Annotating Methods with Exemplars</a></li>
		<li class="page_item page-item-360"><a href="../../3-exemplars/3-2-passing-method-arguments/index.html">3.2. Passing Method Arguments</a></li>
		<li class="page_item page-item-362"><a href="../../3-exemplars/3-3-sin-expressions/index.html">3.3. SIN Expressions</a></li>
		<li class="page_item page-item-364"><a href="../../3-exemplars/3-4-sureassert-named-instances/index.html">3.4. Sureassert Named Instances</a></li>
		<li class="page_item page-item-366"><a href="../../3-exemplars/3-5-specifying-and-initializing-the-object-under-test/index.html">3.5. Specifying and Initializing the Object Under Test</a></li>
		<li class="page_item page-item-368"><a href="../../3-exemplars/3-6-viewing-results-and-other-test-information/index.html">3.6. Viewing Results and Other Test Information</a></li>
		<li class="page_item page-item-370"><a href="../../3-exemplars/3-7-asserting-expected-results/index.html">3.7. Asserting Expected Results</a></li>
		<li class="page_item page-item-372"><a href="../../3-exemplars/3-8-using-exemplars-in-interfaces-and-abstract-classes/index.html">3.8. Using Exemplars in Interfaces and Abstract Classes</a></li>
		<li class="page_item page-item-374"><a href="../../3-exemplars/3-9-setup-and-tear-down-before-and-after/index.html">3.9. Setup and Tear-down (before and after)</a></li>
		<li class="page_item page-item-376"><a href="../../3-exemplars/3-10-further-documenting-your-exemplars/index.html">3.10. Further Documenting your Exemplars</a></li>
		<li class="page_item page-item-378"><a href="../../3-exemplars/3-11-shorthand-exemplar-properties/index.html">3.11. Shorthand Exemplar Properties</a></li>
		<li class="page_item page-item-380"><a href="../../3-exemplars/3-12-inner-classes/index.html">3.12. Inner Classes</a></li>
		<li class="page_item page-item-498"><a href="../../3-exemplars/3-13-avoiding-duplication-in-exemplars-using-the-template-property/index.html">3.13. Avoiding Duplication with Templates</a></li>
	</ul>
</li>
	<li class="page_item page-item-299"><a href="../../4-in-line-assertions/index.html">4. In-line Assertions</a></li>
	<li class="page_item page-item-475 page_item_has_children current_page_ancestor current_page_parent"><a href="../index.html">5. Test Isolation</a>
	<ul class='children'>
		<li class="page_item page-item-477"><a href="../5-1-test-doubles/index.html">5.1. Test Doubles</a></li>
		<li class="page_item page-item-481 current_page_item"><a href="index.html">5.2. Method Stubs</a></li>
		<li class="page_item page-item-486"><a href="../5-3-source-stubs-%e2%80%93-directly-manipulating-the-code-under-test/index.html">5.3. Source Stubs</a></li>
		<li class="page_item page-item-492"><a href="../5-4-expecting-stub-invocation-vstubs/index.html">5.4. Expecting Stub Invocation: vstubs</a></li>
		<li class="page_item page-item-495"><a href="../5-5-default-classes/index.html">5.5. Default Classes</a></li>
	</ul>
</li>
	<li class="page_item page-item-512 page_item_has_children"><a href="../../6-behaviour-verification/index.html">6. Behaviour Verification</a>
	<ul class='children'>
		<li class="page_item page-item-520"><a href="../../6-behaviour-verification/6-1-using-verify-to-perform-behaviour-verification/index.html">6.1. Using verify To Perform Behaviour Verification</a></li>
		<li class="page_item page-item-522"><a href="../../6-behaviour-verification/6-2-verifying-stub-invocation/index.html">6.2. Verifying Stub Invocation</a></li>
	</ul>
</li>
	<li class="page_item page-item-525 page_item_has_children"><a href="../../7-coverage-reporting/index.html">7. Coverage Reporting</a>
	<ul class='children'>
		<li class="page_item page-item-528"><a href="../../7-coverage-reporting/7-1-graphical-in-line-reporting/index.html">7.1. Graphical In-Line Reporting</a></li>
		<li class="page_item page-item-530"><a href="../../7-coverage-reporting/7-2-file-level-information-warnings-and-errors/index.html">7.2. File-level Information, Warnings and Errors</a></li>
		<li class="page_item page-item-532"><a href="../../7-coverage-reporting/7-3-using-ignoretestcoverage/index.html">7.3. Using @IgnoreTestCoverage</a></li>
		<li class="page_item page-item-535"><a href="../../7-coverage-reporting/7-4-configuration/index.html">7.4. Configuration</a></li>
	</ul>
</li>
	<li class="page_item page-item-538 page_item_has_children"><a href="../../8-junit-integration/index.html">8. JUnit Integration</a>
	<ul class='children'>
		<li class="page_item page-item-540"><a href="../../8-junit-integration/8-1-the-junit-library/index.html">8.1. The JUnit Library</a></li>
		<li class="page_item page-item-542"><a href="../../8-junit-integration/8-2-declarative-junit-test-class-association/index.html">8.2. Declarative JUnit Test Class Association</a></li>
		<li class="page_item page-item-544"><a href="../../8-junit-integration/8-3-automatic-junit-execution/index.html">8.3. Automatic JUnit Execution</a></li>
		<li class="page_item page-item-546"><a href="../../8-junit-integration/8-4-sureassert-stubs-with-junit/index.html">8.4. Sureassert Stubs with JUnit</a></li>
	</ul>
</li>
</ul>
</li>
<li class="page_item page-item-84"><a href="../../../documentation/index.html">API Reference</a></li>
<li class="page_item page-item-30"><a href="../../../download/index.html">Download</a></li>
<li class="page_item page-item-77"><a href="../../../getting-started/index.html">Tutorial</a></li>
<li class="page_item page-item-32"><a href="../../../licensing/index.html">Licensing</a></li>
<li class="page_item page-item-36"><a href="../../../forums/index.html">Forums</a></li>
<li class="page_item page-item-34"><a href="../../../support/index.html">Support</a></li>
<li class="page_item page-item-203"><a href="../../../about-us/index.html">About Us</a></li>
</ul></div>
			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">


				<div id="post-481" class="post-481 page type-page status-publish hentry">
											<h1 class="entry-title">5.2. Method Stubs</h1>
					
					<div class="entry-content">
						<p>Method stubs allow you to define in Exemplars and on JUnits (via @Stubs,) what a given method should return at runtime in the testing context. You can direct the stub to take effect on every invocation of a given method, or only when the method parameters match a given expression.</p>
<p>You can stub any method in your project code (source path), but not library classes. If you need to stub an imported library class, one option is to create a delegate class to access the library class and stub that. You could also use source stubbing or in some scenarios, default classes – these are covered later.</p>
<p><strong>5.2.1. Simple Method Stubs</strong></p>
<p>Consider a booking system method that cancels a given booking. This calls a method on a service delegate that calls out to a remote service EJB to cancel a seat:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
@Exemplar(args={&quot;Booking/i1&quot;}, expect=&quot;$arg1.isCancelled&quot;)
public void cancelBooking(Booking booking) throws SeatNotFoundException {

    ...
    try {
        List seatIDs = booking.getSeatIDs();
        for (int seatID : seatIDs) {
            seatServiceDelegate.cancelSeat(seatID);
        }
        booking.setCancelled();
    } catch (NamingException e) {
        throw new TechnicalException(e);
    } catch (RemoteException e) {
        throw new TechnicalException(e);
    }
    ...
}
</pre>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
public class SeatServiceDelegate {

    InitialContext ctx;
    ...

    public void cancelSeat(int seatID) throws NamingException, RemoteException, SeatNotFoundException {

        // Access remote service to cancel the given seat
        SeatService service = (SeatService) ctx.lookup(&quot;SeatService&quot;);
        service.cancel(seatID);
    }

    ...
}
</pre>
<p>The Exemplar will result in a NamingException or RemoteException if the remote service is not accessible, which will be the case in a unit testing context. If it were accessible, this would not be a unit test as it has a dependency on an external resource to function.</p>
<p>In order to test cancelBooking, we need to stub out the SeatService. Our test needs dictate the behaviour of the cancelSeat method; in doing so it can isolate the method-under-test from external dependencies. We can achieve this with a simple method stub definition in our Exemplar:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
@Exemplar(args={&quot;Booking/i1&quot;}, expect=&quot;$arg1.isCancelled&quot;, stubs=&quot;SeatServiceDelegate.cancelSeat&quot;)
public void cancelBooking(Booking booking) throws SeatNotFoundException {
</pre>
<p>Adding the stubs=&#8221;SeatServiceDelegate.cancelSeat&#8221; property to the Exemplar will effectively remove the cancelSeat method call. The Exemplar will then pass as the cancelBooking method will progress to call setCancelled and our expect condition $arg1.isCancelled will return true.</p>
<p>This is the simplest example of method stubbing: we match all invocations of a given method (SeatServiceDelegate.cancelSeat) and remove them. If the stubbed method returned something other than void, we’d have to define what the stub should return. Furthermore the method may be invoked several times, and we might want a different result for each invocation. In addition, we might want to return different values depending on the arguments passed in to the stubbed method.</p>
<p>The rest of this section describes how to use method stubs in these more complex scenarios.</p>
<p><strong>5.2.2. The Stub Match Expression</strong></p>
<p>Stub expressions are of the form:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
matchExpression = resultExpression
</pre>
<p>The match expression determines what method invocations should be stubbed. The match expression takes the form:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
className.methodName(arg1Matcher, arg2Matcher , …)
</pre>
<p>You can use just the simple class name rather than fully-qualified for any project class.</p>
<p><strong>5.2.2.1. The arg Named Instance and Default Argument Matching</strong><br />
To stub a method that has arguments, typically you would specify the class or type of each argument:</p>
<p>For example to stub the following method:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
public class SeatServiceDelegate {

    public int book(List seats, Customer customer, int agencyID);
}
</pre>
<p>You would use the stub expression:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
SeatServiceDelegate.book(List,Customer,int)
</pre>
<p>It is important to note, that each of the method arguments given here is actually using the default argument matcher.</p>
<p>That is: isa(arg,X) where arg is the object or value passes as the argument, and X is the argument match expression given, which was the class name to match (isa is like Java instanceof; see the SIN Operators section for details). In other words, these two match expressions are the same:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
SeatServiceDelegate.book(List,Customer,int)
SeatServiceDelegate.book(isa(List),isa(Customer),isa(int))
</pre>
<p>The significance of this is that your stub match expression doesn’t need to match all invocations of the method to stub. Let’s say that you only want to stub out SeatServiceDelegate.book when the value of the agencyID parameter is 2. You would specify:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
SeatServiceDelegate.book(List,Customer,=(arg,2))
</pre>
<p>Or perhaps you only want the stub to kick in when the customer’s name is Fred and the agencyID is over 1:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
SeatServiceDelegate.book(List, arg.name.equalsIgnoreCase(“Fred”), &gt;(arg,1))
</pre>
<p>Using stub argument matchers like this, you can define different stub results for different invocations of the stubbed methods, depending on the value of the parameters passed in.</p>
<p><strong>5.2.2.2. The Wildcard Matcher and Omitting Matcher Expressions</strong></p>
<p>You can use the wildcard matcher “*” to match any argument value or type, so:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
SeatServiceDelegate.book(*, *, *)
</pre>
<p>Would match any invocation of SeatServiceDelegate.book that passed 3 parameters.</p>
<p>Futhermore, you do not have to specify parameters at all. Specifying just:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
SeatServiceDelegate.book
</pre>
<p>Would match any invocation of any method in SeatServiceDelegate named book.</p>
<p>Be careful with using the wildcard in stub expressions though: there could be several methods in a class with the same name and number of parameters, but with differing return types. And even if there isn’t, a method might be overloaded at a later date which could break your stub.</p>
<p>Wildcard matchers are more useful in verify expressions. See the Behaviour Verification section for details of these.</p>
<p><strong>5.2.3. The Stub Result Expression</strong></p>
<p>Stub expressions are of the form:<br />
matchExpression = resultExpression</p>
<p>The result expression defines what is returned by the stubbed method. It can only be specified for non-void methods, or when you want to throw an exception from the stub.</p>
<p><strong>5.2.3.1. Specifying a Result</strong></p>
<p>You can specify a value to return from the stub, or any expression that returns a value that is compatible with the return type of the stubbed method.</p>
<p>For example to stub this method and return the value 1 from it:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
public class SeatServiceDelegate {
    public int book(List seats, Customer customer, int agencyID);
}
</pre>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
stubs=&quot;SeatServiceDelegate.book(List,Customer,int) = 1&quot;
</pre>
<p>Or you may want to call a method in your test code that gets you a value to return from the stub:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
stubs=&quot;SeatServiceDelegate.book(List,Customer,int) = TestUtils.bookStub()&quot;
</pre>
<p><strong>5.2.3.2. Using the Stub Method Instance and Arguments in the Result Expression</strong></p>
<p>If your stub result expression is calling a method to get the stub result, it’s likely you’ll want need to give it information about the stubbed method. You can use the obj and arg1..n named instances to refer to the object being invoked and the arguments of the stubbed method call respectively. For instance you might want to generate a return value from the stub in test code, based the stubbed method’s argument values and the object on which the method was called:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
stubs=&quot;SeatServiceDelegate.book(List,Customer,int) = TestUtils.bookStub(obj,arg1,arg2,arg3)&quot;
</pre>
<p>Then in TestUtils:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
public class TestUtils {

    public static int bookStub(SeatServiceDelegate instance, List seats, Customer customer, int agencyID) {

        for (Seat seat : seats) {
            seat.setBooked(true);
        }
        // ... work with instance, seats, customer and/or agencyID as required ...
        return seats.size();
    }
}
</pre>
<p><strong>5.2.3.3. Specifying Multiple Results with a Stub List</strong></p>
<p>Sometimes, you may want your stub to return different results, or behave differently, for each invocation of the stubbed method.</p>
<p>You can specify different results for each stub invocation by using the special stub list SIN Type: [sl:expr1,exprN]. The list contains a list of expressions; one intended for each invocation of the stubbed method. If the stub is executed more times than there are expressions in the stub list, the last expression will be used repeatedly.</p>
<p>For example if you want the book method to return 1 on the first invocation, 10 on the second, and 50 on the third, you could specify:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
stubs=&quot;SeatServiceDelegate.book(List,Customer,int)=sl:1,10,50&quot;
</pre>
<p>You can use any expression within stub lists, not just values. So if necessary you could call different methods or pass different argument values depending on a position in the invocation sequence.</p>
<p><strong>5.2.3.4. Throwing an Exception</strong></p>
<p>You can specify that a subbed method throws any given exception. To do this, use ^= rather than =:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
matchExpression ^= exceptionResultExpression
</pre>
<p>The exceptionResultExpression is any expression that returns a Throwable object. The Throwable needs to be of a type supported by the stubbed method’s signature, i.e. it needs to be on the list of exceptions declared in the stubbed method’s throws clause.</p>
<p>In the following example, we’re testing the scenario where the cancelSeat method throws a RemoteException:</p>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
@Exemplar(args={&quot;Booking/i1&quot;}, expectexception=&quot;TechnicalException&quot;, expect=&quot;retval.getCause().getMessage().equals(‘test msg’)&quot;, stubs=&quot;SeatServiceDelegate.cancelSeat^=new java/net/RemoteException('test msg')&quot;)
public void cancelBooking(Booking booking) throws SeatNotFoundException {

    ...
    try {
        List seatIDs = booking.getSeatIDs();
        for (int seatID : seatIDs) {
            seatServiceDelegate.cancelSeat(seatID);
        }
        booking.setCancelled();
    } catch (NamingException e) {
        throw new TechnicalException(e);
    } catch (RemoteException e) {
        throw new TechnicalException(e);
    }
    ...
}
</pre>
<pre class="brush: java; gutter: false; title: ; notranslate" title="">
public class SeatServiceDelegate {

    InitialContext ctx;
    ...
    public void cancelSeat(int seatID) throws NamingException, RemoteException, SeatNotFoundException {
        // Access remote service to cancel the given seat
        SeatService service = (SeatService) ctx.lookup(&quot;SeatService&quot;);
        service.cancel(seatID);
    }
    ...
}
</pre>
<p><a title="5.1. Test Doubles" href="../5-1-test-doubles/index.html">Previous Page</a> &nbsp;&nbsp;|&nbsp;&nbsp; <a title="5.3.	Source Stubs" href="../5-3-source-stubs-%e2%80%93-directly-manipulating-the-code-under-test/index.html">Next Page</a> &nbsp;&nbsp;|&nbsp;&nbsp; <a title="Guide" href="../../index.html">Table of Contents</a></p>
																	</div><!-- .entry-content -->
				</div><!-- #post-## -->

				
			<div id="comments">


	<p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->


			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
			<ul class="xoxo">

	
			<li id="search" class="widget-container widget_search">
				<form role="search" method="get" id="searchform" class="searchform" action="http://www.sureassert.com/uc/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>			</li>

			<li id="archives" class="widget-container">
				<h3 class="widget-title">Archives</h3>
				<ul>
									</ul>
			</li>

			<li id="meta" class="widget-container">
				<h3 class="widget-title">Meta</h3>
				<ul>
					<li><a href="../../../../wp-login0ddc.html?action=register">Register</a></li>					<li><a href="../../../../wp-login.html">Log in</a></li>
									</ul>
			</li>

					</ul>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="../../../index.html" title="Sureassert UC" rel="home">
					Sureassert UC				</a>
				<sup>TM</sup> &nbsp;&nbsp;©2011 N Dolan
			</div><!-- #site-info -->

			<div id="site-generator">
								<a href="http://wordpress.org/"
						title="Semantic Personal Publishing Platform" rel="generator">
					
				</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

<script type='text/javascript' src='../../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore677a.js?ver=3.0.9'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava677a.js?ver=3.0.9'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "../../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore677a.css?ver=3.0.9";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "../../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault677a.css?ver=3.0.9";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='../../../../wp-includes/js/comment-reply.mine100.js?ver=4.7.2'></script>
<script type='text/javascript' src='../../../../wp-includes/js/wp-embed.mine100.js?ver=4.7.2'></script>
</body>

<!-- Mirrored from www.sureassert.com/uc/guide/5-test-isolation/5-2-method-stubs/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 04 Mar 2017 11:46:05 GMT -->
</html>
